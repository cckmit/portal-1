---
title: "Экземпляры Портала"
description: >
  Различные экземпляры Портала: внешний и внутренний
type: docs
weight: 4
gitlab_project_path: "department-7/portal"
gitlab_project_name: "portal"
gitlab_docs_branch: "master"
gitlab_docs_path: "docs"
gitlab_docs_enable_edit: true
gitlab_docs_enable_edit_ide: true
gitlab_docs_enable_new_issue: false
---


## Порталы:
### Внутренний

**url:**  https://portal.protei.ru/

**ip:** 192.168.110.68

**Особенности:**
Не виден в Интернете, доступ есть только из локальной сети (из-под ВПН)
И, например, вебхуки Jira необходимо отдельно прокидывать через сервер внешнего Портала

Некоторая логика производится только на Внутреннем Портале - отключается через проперти на внешнем:
- миграции,
- канал интеграций Jira/Redmine/Youtrack -> Портал
- задачи по расписанию (task.scheduler.enabled)


### Внешний

**url:**  https://crm.protei.ru/

**ip:** 10.0.0.18

**Особенности:**
Виден в интернете, через него имеют доступ заказчики или внешние сотрудники без ВПН

### Общее
- Это одно и то же приложение Портала. Jenkins производит обновление одновременно.
- Работают на одной той же базе.
- канал интеграций Портал -> Jira/Redmine/Youtrack - на каком Портале были сделаны изменения, тот и отправляет изменения в канал интеграции
- рассылки по обращениям - на каком Портале были сделаны изменения, тот и отправляет письмо 

### Различия

У каждого инстанса свой "Идентификатор системы"
```
## Идентиификатор системы (EXTERNAL / INTERNAL)
## default: ""
system.id=INTERNAL
```

#### Авторизация

Через LDAP или локальные учетные записи - не отличаются и подходят к обоим инстансам.

Кросс авторизации нет - на каждом Портале необходимо авторизоваться отдельно.

Есть проперти с суффиксом логина, сделано для миграции. Раньше учетки были без суффикса.
Потом решено использовать логины по аналогии с почтой и к старым учеткам на внешнем портале 
для совместимости стали автоматически подставляться суффиксы
```
## внешний портал параметер
## default: ""
auth.login.suffix=@crm.protei.ru
```

#### Интеграции

- канал "backchannel" PORTAL -> Jira/Redmine/Youtrack - на каком Портале были сделаны изменения, тот и отправляет изменения в канал интеграции
- Jira/Redmine/Youtrack -> PORTAL - только Внутренний Портал, на внешнем отключено через проперти
```properties
# integration configuration
integration.hpsm=false
integration.redmine=false
integration.redmine.backchannel=true
integration.youtrack=false
integration.jira=false
integration.jira.backchannel=true
```

#### Отчеты
Отчеты хранятся локально на сервере (не на облаке), поэтому заказанный отчет во Внутреннем
даже не отобразится на Внешнем Портале

#### Рассылки:
Сотруднику Протея (определяется по доменному имени почты) все ссылки ведут на Внутренний Портал, остальным - на Внешний.  

#### Фото:
На внешнем Портале отсутствуют фото сотрудников, все аватарки обезличены.

Сделано потому, что не все сотрудники согласны показывать себя заказчикам.

#### Боковое меню:
На Внутреннем Портале в в конце бокового меню добавляется ссылки на внутренние ресурсы - "Ютрек", "старый Портал", "Архив" и тп

Хранятся ссылки в cfg/links.html


